<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      th:replace="~{fragments/layout :: layout(title=~{::title}, content=~{::main}, scripts=~{::scripts})}">

<head>
    <title th:fragment="title">C√†i ƒë·∫∑t - IoT Manager</title>
</head>

<main th:fragment="main">
    <style>
        .settings-container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 30px 15px;
        }

        .settings-header {
            margin-bottom: 30px;
        }

        .settings-header h3 {
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .settings-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
            padding: 24px;
            margin-bottom: 24px;
        }

        .settings-card h5 {
            font-weight: 600;
            color: #4e73df;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 2px solid #e3e6f0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .settings-item {
            padding: 16px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .settings-item:last-child {
            border-bottom: none;
        }

        .settings-item-title {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 4px;
        }

        .settings-item-desc {
            font-size: 14px;
            color: #6c757d;
            margin-bottom: 12px;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 26px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: not-allowed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 26px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        .disabled-message {
            display: inline-block;
            margin-left: 12px;
            font-size: 13px;
            color: #6c757d;
            font-style: italic;
        }

        .theme-option {
            display: flex;
            align-items: center;
            padding: 12px;
            border: 2px solid #e3e6f0;
            border-radius: 8px;
            margin-bottom: 12px;
            cursor: not-allowed;
            opacity: 0.6;
            transition: all 0.3s;
        }

        .theme-option:hover {
            border-color: #ccc;
        }

        .theme-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            margin-right: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .language-select {
            max-width: 300px;
            cursor: not-allowed;
            opacity: 0.6;
        }

        .alert-feature {
            background: #fff3cd;
            border: 1px solid #ffc107;
            border-radius: 8px;
            padding: 12px 16px;
            margin-top: 12px;
        }
    </style>

    <div class="settings-container">
        <div class="settings-header">
            <h3><i class="bi bi-gear-fill me-2"></i>C√†i ƒë·∫∑t</h3>
            <p class="text-muted">Qu·∫£n l√Ω t√πy ch·ªçn v√† c√†i ƒë·∫∑t h·ªá th·ªëng c·ªßa b·∫°n</p>
        </div>

        <!-- Success/Error Messages -->
        <div th:if="${success}" class="alert alert-success alert-dismissible fade show" role="alert">
            <i class="bi bi-check-circle me-2"></i><span th:text="${success}"></span>
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
        <div th:if="${error}" class="alert alert-danger alert-dismissible fade show" role="alert">
            <i class="bi bi-x-circle me-2"></i><span th:text="${error}"></span>
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>

        <form id="settingsForm" method="post" th:action="@{/settings/update}">
            <!-- CSRF Token -->
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>

        <!-- Appearance Settings -->
        <div class="settings-card">
            <h5><i class="bi bi-palette"></i> Giao di·ªán</h5>
            
            <div class="settings-item">
                <div class="settings-item-title">Ch·∫ø ƒë·ªô giao di·ªán</div>
                <div class="settings-item-desc">Ch·ªçn giao di·ªán s√°ng ho·∫∑c t·ªëi cho h·ªá th·ªëng</div>
                
                <select class="form-select" name="uiTheme" style="max-width: 300px;">
                    <option value="light" th:selected="${uiTheme == 'light'}">üåû Ch·∫ø ƒë·ªô s√°ng</option>
                    <option value="dark" th:selected="${uiTheme == 'dark'}">üåô Ch·∫ø ƒë·ªô t·ªëi</option>
                    <option value="auto" th:selected="${uiTheme == 'auto'}">üîÑ T·ª± ƒë·ªông</option>
                </select>
                <small class="text-muted d-block mt-2">
                    <i class="bi bi-info-circle"></i> Ch·∫ø ƒë·ªô t·ªëi ƒëang ƒë∆∞·ª£c ph√°t tri·ªÉn
                </small>
            </div>

            <div class="settings-item">
                <div class="settings-item-title">Ng√¥n ng·ªØ hi·ªÉn th·ªã</div>
                <div class="settings-item-desc">Ch·ªçn ng√¥n ng·ªØ cho giao di·ªán h·ªá th·ªëng</div>
                
                <select class="form-select language-select" name="uiLanguage" style="max-width: 300px; cursor: pointer; opacity: 1;">
                    <option value="vi" th:selected="${uiLanguage == 'vi'}">üáªüá≥ Ti·∫øng Vi·ªát</option>
                    <option value="en" th:selected="${uiLanguage == 'en'}">üá¨üáß English</option>
                    <option value="ja" th:selected="${uiLanguage == 'ja'}">üáØüáµ Êó•Êú¨Ë™û</option>
                </select>
                <small class="text-muted d-block mt-2">
                    <i class="bi bi-info-circle"></i> Hi·ªán t·∫°i ch·ªâ h·ªó tr·ª£ Ti·∫øng Vi·ªát
                </small>
            </div>
        </div>

        <!-- Notification Settings -->
        <div class="settings-card">
            <h5><i class="bi bi-bell"></i> Th√¥ng b√°o</h5>
            
            <div class="settings-item">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <div class="settings-item-title">Th√¥ng b√°o Email</div>
                        <div class="settings-item-desc">Nh·∫≠n th√¥ng b√°o qua email khi c√≥ s·ª± ki·ªán quan tr·ªçng</div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" name="notifEmailEnabled" value="true" 
                               th:checked="${notifEmailEnabled}" style="cursor: pointer;">
                        <span class="toggle-slider" style="cursor: pointer;"></span>
                    </label>
                </div>
            </div>

            <div class="settings-item">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <div class="settings-item-title">Th√¥ng b√°o thi·∫øt b·ªã</div>
                        <div class="settings-item-desc">Nh·∫≠n c·∫£nh b√°o khi thi·∫øt b·ªã c√≥ v·∫•n ƒë·ªÅ ho·∫∑c ngo·∫°i l·ªá</div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" name="notifDeviceEnabled" value="true" 
                               th:checked="${notifDeviceEnabled}" style="cursor: pointer;">
                        <span class="toggle-slider" style="cursor: pointer;"></span>
                    </label>
                </div>
            </div>

            <div class="settings-item">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <div class="settings-item-title">√Çm thanh th√¥ng b√°o</div>
                        <div class="settings-item-desc">Ph√°t √¢m thanh khi c√≥ th√¥ng b√°o m·ªõi</div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" name="notifSoundEnabled" value="true" 
                               th:checked="${notifSoundEnabled}" style="cursor: pointer;">
                        <span class="toggle-slider" style="cursor: pointer;"></span>
                    </label>
                </div>
            </div>
        </div>

        <!-- Privacy & Security -->
        <div class="settings-card">
            <h5><i class="bi bi-shield-check"></i> B·∫£o m·∫≠t & Quy·ªÅn ri√™ng t∆∞</h5>
            
            <div class="settings-item">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <div class="settings-item-title">X√°c th·ª±c 2 y·∫øu t·ªë (2FA)</div>
                        <div class="settings-item-desc">Th√™m l·ªõp b·∫£o m·∫≠t b·ªï sung cho t√†i kho·∫£n c·ªßa b·∫°n</div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" name="security2FAEnabled" value="true" 
                               th:checked="${security2FAEnabled}" style="cursor: pointer;">
                        <span class="toggle-slider" style="cursor: pointer;"></span>
                    </label>
                </div>
            </div>

            <div class="settings-item">
                <div class="settings-item-title">Th·ªùi gian timeout phi√™n (ph√∫t)</div>
                <div class="settings-item-desc">T·ª± ƒë·ªông ƒëƒÉng xu·∫•t sau kho·∫£ng th·ªùi gian kh√¥ng ho·∫°t ƒë·ªông</div>
                <div class="mt-2">
                    <input type="number" class="form-control" name="securitySessionTimeout" 
                           th:value="${securitySessionTimeout}" min="5" max="120" style="max-width: 200px;">
                </div>
            </div>

            <div class="settings-item">
                <div class="settings-item-title">ƒê·ªô d√†i m·∫≠t kh·∫©u t·ªëi thi·ªÉu</div>
                <div class="settings-item-desc">S·ªë k√Ω t·ª± t·ªëi thi·ªÉu cho m·∫≠t kh·∫©u m·ªõi</div>
                <div class="mt-2">
                    <input type="number" class="form-control" name="securityPasswordMinLength" 
                           th:value="${securityPasswordMinLength}" min="6" max="32" style="max-width: 200px;">
                </div>
            </div>
        </div>

        <!-- Data & Storage -->
        <div class="settings-card">
            <h5><i class="bi bi-database"></i> D·ªØ li·ªáu & L∆∞u tr·ªØ</h5>
            
            <div class="settings-item">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <div class="settings-item-title">T·ª± ƒë·ªông sao l∆∞u d·ªØ li·ªáu</div>
                        <div class="settings-item-desc">T·ª± ƒë·ªông sao l∆∞u d·ªØ li·ªáu thi·∫øt b·ªã ƒë·ªãnh k·ª≥</div>
                    </div>
                    <label class="toggle-switch">
                        <input type="checkbox" name="dataBackupEnabled" value="true" 
                               th:checked="${dataBackupEnabled}" style="cursor: pointer;">
                        <span class="toggle-slider" style="cursor: pointer;"></span>
                    </label>
                </div>
            </div>

            <div class="settings-item">
                <div class="settings-item-title">Kho·∫£ng th·ªùi gian sao l∆∞u (gi·ªù)</div>
                <div class="settings-item-desc">Chu k·ª≥ sao l∆∞u d·ªØ li·ªáu t·ª± ƒë·ªông</div>
                <div class="mt-2">
                    <input type="number" class="form-control" name="dataBackupInterval" 
                           th:value="${dataBackupInterval}" min="1" max="168" style="max-width: 200px;">
                </div>
            </div>

            <div class="settings-item">
                <div class="settings-item-title">Th·ªùi gian l∆∞u tr·ªØ d·ªØ li·ªáu (ng√†y)</div>
                <div class="settings-item-desc">S·ªë ng√†y l∆∞u tr·ªØ d·ªØ li·ªáu l·ªãch s·ª≠</div>
                <div class="mt-2">
                    <input type="number" class="form-control" name="dataRetentionDays" 
                           th:value="${dataRetentionDays}" min="7" max="365" style="max-width: 200px;">
                </div>
            </div>
        </div>

        <!-- About -->
        <div class="settings-card">
            <h5><i class="bi bi-info-circle"></i> Th√¥ng tin h·ªá th·ªëng</h5>
            
            <div class="settings-item">
                <div class="row">
                    <div class="col-md-4">
                        <div class="settings-item-title">T√™n ·ª©ng d·ª•ng</div>
                        <div class="settings-item-desc" th:text="${appName}">IoT Device Manager</div>
                    </div>
                    <div class="col-md-4">
                        <div class="settings-item-title">Phi√™n b·∫£n</div>
                        <div class="settings-item-desc" th:text="${appVersion}">v1.0.0</div>
                    </div>
                    <div class="col-md-4">
                        <div class="settings-item-title">M√¥ t·∫£</div>
                        <div class="settings-item-desc" th:text="${appDescription}">H·ªá th·ªëng qu·∫£n l√Ω IoT</div>
                    </div>
                </div>
            </div>

            <div class="settings-item">
                <div class="row">
                    <div class="col-md-6">
                        <div class="settings-item-title">Email h·ªó tr·ª£</div>
                        <div class="settings-item-desc" th:text="${supportEmail}">support@iotmanager.com</div>
                    </div>
                    <div class="col-md-6">
                        <div class="settings-item-title">S·ªë ƒëi·ªán tho·∫°i</div>
                        <div class="settings-item-desc" th:text="${supportPhone}">+84 123 456 789</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Save Button -->
        <div class="d-flex justify-content-end gap-2 mt-4 mb-3">
            <button type="reset" class="btn btn-secondary">
                <i class="bi bi-x-circle"></i> H·ªßy b·ªè
            </button>
            <button type="submit" class="btn btn-primary">
                <i class="bi bi-check-circle"></i> L∆∞u c·∫•u h√¨nh
            </button>
        </div>

        </form>
    </div>

    <th:block th:fragment="scripts">
        <script>
            console.log('Settings page loaded - Configuration management enabled');
        </script>
    </th:block>
</main>
</html>
